{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction (val) {\r\n    return typeof val === 'function'\r\n}\r\n\r\nexport function isObject (val) {\r\n    return typeof val === 'object' && val !== null\r\n}","import { isObject } from \"../utils\";\r\n\r\nclass Observer {\r\n    // 对对象中的所有属性进行劫持\r\n    constructor (data) {\r\n        this.walk(data)\r\n    }\r\n    walk(data) {\r\n        Object.keys(data).forEach(key => {\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n}\r\n\r\n// vue2 会对对象进行遍历，将每个属性使用defineProperty 重新定义，导致性能差\r\nfunction defineReactive(data, key, value) {\r\n    // 如果value是一个对象，则继续递归进行劫持\r\n    observe(value) \r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newV) {\r\n            // 如果用户赋值一个新对象，需要将这个对象进行劫持\r\n            observe(newV)\r\n            value = newV\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    // 如果是对象才观察（省略对数组进行处理）\r\n    if (!isObject(data)) {\r\n        return\r\n    }\r\n    \r\n    // 默认最外层 data 必须是一个对象\r\n    return new Observer(data)\r\n}","import { isFunction } from \"./utils\"\r\nimport { observe } from \"./observer/index\"\r\n\r\nexport function initState (vm) {\r\n    const opts = vm.$options\r\n    // 初始化data\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n    // 初始化方法\r\n    if (opts.methods) {\r\n        initMethod(vm)\r\n    }\r\n    // 初始化 props\r\n    if (opts.props) {\r\n        initProps(vm)\r\n    }\r\n    // 初始化 computed\r\n    if (opts.computed) {\r\n        initComputed(vm)\r\n    }\r\n    // 初始化 watch\r\n    if (opts.watch) {\r\n        initWatch(vm)\r\n    }\r\n    \r\n    function initData(vm) {\r\n        let data = vm.$options.data\r\n        // vue2 中会将data 中的所有数值进行数据劫持(Object.defineProperty)\r\n        // 如果传入的data 是一个方法，则取其返回值，否则取其值\r\n        data = vm._data = isFunction(data) ? data.call(vm) : data\r\n\r\n        // 数据响应式\r\n        observe(data)\r\n    }\r\n\r\n    // 未实现的方法\r\n    function initProps() {}\r\n    function initMethod() {}\r\n    function initComputed() {}\r\n    function initWatch() {}\r\n}","import { initState } from \"./state\"\r\n\r\nexport function initMixin (Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        // el, data\r\n        const vm = this\r\n        vm.$options = options\r\n\r\n        // 对数据进行初始化（watch、computed、props、data...）\r\n        // 这些数据都存在于vm.options\r\n        initState(vm)\r\n    }\r\n}","import { initMixin } from \"./init\"\r\n\r\nfunction Vue(options) {\r\n    // options 为用户传入的选项\r\n    this._init(options) // 初始化操作、组件\r\n}\r\n\r\n// 给原型上新增_init 方法\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":[],"mappings":";;;;;;IAAO,SAAS,UAAU,EAAE,GAAG,EAAE;IACjC,IAAI,OAAO,OAAO,GAAG,KAAK,UAAU;IACpC,CAAC;AACD;IACO,SAAS,QAAQ,EAAE,GAAG,EAAE;IAC/B,IAAI,OAAO,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,IAAI;IAClD;;ICJA,MAAM,QAAQ,CAAC;IACf;IACA,IAAI,WAAW,CAAC,CAAC,IAAI,EAAE;IACvB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,EAAC;IACvB,KAAK;IACL,IAAI,IAAI,CAAC,IAAI,EAAE;IACf,QAAQ,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI;IACzC,YAAY,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAC;IAChD,SAAS,EAAC;IACV,KAAK;IACL,CAAC;AACD;IACA;IACA,SAAS,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE;IAC1C;IACA,IAAI,OAAO,CAAC,KAAK,EAAC;IAClB,IAAI,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE;IACrC,QAAQ,GAAG,GAAG;IACd,YAAY,OAAO,KAAK;IACxB,SAAS;IACT,QAAQ,GAAG,CAAC,IAAI,EAAE;IAClB;IACA,YAAY,OAAO,CAAC,IAAI,EAAC;IACzB,YAAY,KAAK,GAAG,KAAI;IACxB,SAAS;IACT,KAAK,EAAC;IACN,CAAC;AACD;IACO,SAAS,OAAO,CAAC,IAAI,EAAE;IAC9B;IACA,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;IACzB,QAAQ,MAAM;IACd,KAAK;IACL;IACA;IACA,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC;IAC7B;;ICnCO,SAAS,SAAS,EAAE,EAAE,EAAE;IAC/B,IAAI,MAAM,IAAI,GAAG,EAAE,CAAC,SAAQ;IAC5B;IACA,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE;IACnB,QAAQ,QAAQ,CAAC,EAAE,EAAC;IACpB,KAAK;IACL;IACA,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE,CAEjB;IACL;IACA,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE,CAEf;IACL;IACA,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE,CAElB;IACL;IACA,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE,CAEf;IACL;IACA,IAAI,SAAS,QAAQ,CAAC,EAAE,EAAE;IAC1B,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,KAAI;IACnC;IACA;IACA,QAAQ,IAAI,GAAG,EAAE,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,KAAI;AACjE;IACA;IACA,QAAQ,OAAO,CAAC,IAAI,EAAC;IACrB,KAAK;IAOL;;ICvCO,SAAS,SAAS,EAAE,GAAG,EAAE;IAChC,IAAI,GAAG,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,OAAO,EAAE;IAC7C;IACA,QAAQ,MAAM,EAAE,GAAG,KAAI;IACvB,QAAQ,EAAE,CAAC,QAAQ,GAAG,QAAO;AAC7B;IACA;IACA;IACA,QAAQ,SAAS,CAAC,EAAE,EAAC;IACrB,MAAK;IACL;;ICVA,SAAS,GAAG,CAAC,OAAO,EAAE;IACtB;IACA,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;IACvB,CAAC;AACD;IACA;IACA,SAAS,CAAC,GAAG;;;;;;;;"}